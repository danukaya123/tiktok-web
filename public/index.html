<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TikTok Downloader</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; padding: 2rem; }
  input { width: 60%; padding: 0.5rem; font-size: 1rem; }
  button { padding: 0.5rem 1rem; font-size: 1rem; margin: 0.5rem; cursor: pointer; }
  img { max-width: 200px; margin-top: 1rem; }
</style>
</head>
<body>
<h1>üì• TikTok Downloader</h1>
<input type="text" id="url" placeholder="Paste TikTok link here" />
<button onclick="fetchTikTok()">Download</button>

<div id="result"></div>

<script>
async function fetchTikTok() {
  const url = document.getElementById('url').value.trim();
  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = "‚è≥ Fetching...";

  if (!url) {
    resultDiv.innerHTML = "‚ùå Please enter a TikTok URL.";
    return;
  }

  try {
    const res = await fetch(`/api/tiktok?url=${encodeURIComponent(url)}`);
    const data = await res.json();

    if (data.error) {
      resultDiv.innerHTML = "‚ùå " + data.error;
      return;
    }

    resultDiv.innerHTML = `
      <h2>${data.title}</h2>
      <img src="${data.thumbnail}" alt="Thumbnail" />
      <div>
        <button onclick="downloadFile('${data.noWatermark}', '${data.title}.mp4')">‚¨áÔ∏è Download Video</button>
        <button onclick="downloadFile('${data.audio}', '${data.title}.mp3')">üéß Download Audio</button>
      </div>
    `;

  } catch (err) {
    console.error(err);
    resultDiv.innerHTML = "‚ùå Failed to fetch video.";
  }
}

// Helper to download files
function downloadFile(fileUrl, filename) {
  const a = document.createElement('a');
  a.href = fileUrl;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>
</body>
</html>
